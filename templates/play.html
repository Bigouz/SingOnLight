<!doctype html>
<html>
<head>
<title>Sing On Light - Jouer</title>
</head>
<body>
<div class = "parent">
    <div class="div1">
        <div class = "div1a">
            <a class="indexBTN" href="/">Menu Principal</a><br>
            <a class="playBTN" id="currentBTN" href="/play.html">Jouer</a><br>
            <a class="calibrationBTN" href="/calibration.html">Calibration</a><br>
            <a class="dataBTN" href="/data.html">Données</a><br>
            <a href="https://github.com/Bigouz/Projet-L1-Informatique-1er-semestre" class="github">GitHub</a>

        </div>    
    </div>
    <div class="div2">
        <h1>Sing On Light - Jouer</h1>
        <div class="text">
            <p>Lorsque vous appuyez sur "Jouer", les paramètres seront sauvegardés et la partie commencera immédiatement. 
            <br>Votre but est de reproduire les notes jouées en chantant ou en parlant.
            <br>
            </br>Choisissez vos paramètres de jeu ci-dessous :
            <br><br>

            <label for="dureeIntervalle">Durée d'intervalles (en secondes) : </label>
            <input type="number" name="dureeIntervalle" id="dureeIntervalle" value="{{dureeIntervalle}}" max="2" min="0.1" step="0.1"><br>

            <label for="dureePartie">Durée de la partie (en intervalles) : </label>
            <input type="number" name="dureePartie" id="dureePartie" value="{{dureePartie}}" max="60" min="5"><br>
            <button class="start" onclick="save_param()">Jouer</button>
            <br><br>
            <p style="color: lime;" id="result">{{message}}</p>
            </p>
            
            <script>
            async function save_param() {
                const dureeIntervalle = parseInt(document.getElementById('dureeIntervalle').value);
                const dureePartie = parseInt(document.getElementById('dureePartie').value);

                
                // Send parameters via POST with JSON body
                const response = await fetch('/run_play', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({"dureeIntervalle":dureeIntervalle, "dureePartie":dureePartie})
                });
                const data = await response.json();
                document.getElementById('result').innerText = data;
            }
        </script>
        </div>
    </div>
</div>
<link rel="stylesheet" href="static/css/style.css">
</body>
</html>
